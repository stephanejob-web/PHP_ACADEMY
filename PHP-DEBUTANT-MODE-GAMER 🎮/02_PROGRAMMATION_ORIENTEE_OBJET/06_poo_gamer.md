# üéÆ POO pour Gamers - Cours 06 : Public, Private, Protected (anti-cheat !)

## üïπÔ∏è Salut le gamer !

Jusqu'√† maintenant, toutes tes stats √©taient **`public`**.

√áa veut dire que **N'IMPORTE QUI** peut les modifier :

```php
$guerrier->pv = 120;
$guerrier->pv = 99999; // PROBL√àME ! Un tricheur peut modifier les PV !
```

**C'est dangereux !** üò±

Aujourd'hui, tu vas apprendre √† **PROT√âGER** tes stats pour √©viter que n'importe qui triche avec ton jeu !

C'est ce qu'on appelle **l'encapsulation**. üîí

---

## ü§î C'est quoi le probl√®me avec `public` ?

Regarde ce code :

```php
<?php
class Personnage {
    public $nom;
    public $pv;
    public $pv_max;
    public $force;

    public function __construct($n, $pv, $f) {
        $this->nom = $n;
        $this->pv = $pv;
        $this->pv_max = $pv;
        $this->force = $f;
    }
}

$guerrier = new Personnage("Thorin", 120, 30);

// Un tricheur peut faire des B√äTISES !
$guerrier->pv = 99999; // Des PV infinis ?!
$guerrier->force = -50; // Une force n√©gative ?!
$guerrier->pv_max = 0; // PV max √† z√©ro ?!

echo "PV : " . $guerrier->pv . "<br>";
?>
```

---

### üì∫ R√©sultat :

```
PV : 99999
```

**DES PV √Ä 99999 ?!** ü§Ø

√áa n'a **AUCUN SENS** !

**Le probl√®me** : Avec `public`, n'importe qui peut mettre n'importe quoi, m√™me tricher !

---

## üîí Les 3 niveaux de protection

En POO, tu as **3 mots-cl√©s** pour prot√©ger tes stats et m√©thodes :

| Mot-cl√© | Visibilit√© | Qui peut y acc√©der ? |
|---------|------------|----------------------|
| **`public`** | üåç Partout | Tout le monde |
| **`private`** | üîí Priv√© | Seulement la classe elle-m√™me |
| **`protected`** | üõ°Ô∏è Prot√©g√© | La classe + les classes enfants |

---

### üåç `public` - Accessible partout

```php
class Personnage {
    public $nom; // Tout le monde peut lire et modifier
}

$perso = new Personnage();
$perso->nom = "Thorin"; // ‚úÖ OK
```

**Utilise `public` pour :** Les choses qui peuvent √™tre librement modifi√©es sans danger.

---

### üîí `private` - Accessible SEULEMENT dans la classe

```php
class Personnage {
    private $pv; // Personne ne peut y acc√©der de l'ext√©rieur
}

$perso = new Personnage();
$perso->pv = 120; // ‚ùå ERREUR ! PHP va r√¢ler
```

**Utilise `private` pour :** Les stats sensibles qu'on doit prot√©ger (comme les PV).

---

### üõ°Ô∏è `protected` - Accessible dans la classe + les enfants

```php
class Personnage {
    protected $pv; // La classe + les classes enfants peuvent y acc√©der
}

class Guerrier extends Personnage {
    public function afficherPV() {
        echo $this->pv; // ‚úÖ OK, je suis un enfant
    }
}

$perso = new Guerrier();
$perso->pv = 120; // ‚ùå ERREUR ! Pas accessible de l'ext√©rieur
```

**Utilise `protected` pour :** Les stats partag√©es avec les classes enfants, mais pas avec l'ext√©rieur.

---

## üõ°Ô∏è Exemple avec `private`

```php
<?php
class Personnage {
    private $nom;
    private $pv;
    private $pv_max;
    private $force;

    public function __construct($n, $pv, $f) {
        $this->nom = $n;
        $this->pv = $pv;
        $this->pv_max = $pv;
        $this->force = $f;
    }

    public function attaquer() {
        $degats = $this->force;
        echo $this->nom . " attaque ! (" . $degats . " d√©g√¢ts)<br>";
        return $degats;
    }
}

$guerrier = new Personnage("Thorin", 120, 30);

$guerrier->attaquer(); // ‚úÖ OK

echo $guerrier->pv; // ‚ùå ERREUR ! pv est private
?>
```

**Maintenant, personne ne peut modifier directement les PV !**

Mais... **comment on fait pour lire ou modifier les stats alors ?** ü§î

---

## üîë Les GETTERS et SETTERS (les contr√¥leurs anti-triche)

Les **getters** et **setters** sont des **m√©thodes** qui permettent de :
- **LIRE** (get) une stat priv√©e
- **MODIFIER** (set) une stat priv√©e **avec des contr√¥les anti-triche**

---

### Exemple complet avec getters et setters

```php
<?php
class Personnage {
    private $nom;
    private $pv;
    private $pv_max;
    private $force;

    public function __construct($n, $pv, $f) {
        $this->setNom($n); // J'utilise le setter pour contr√¥ler
        $this->setPV($pv);
        $this->setForce($f);
    }

    // GETTER : lire le nom
    public function getNom() {
        return $this->nom;
    }

    // SETTER : modifier le nom (avec CONTR√îLE !)
    public function setNom($n) {
        if (empty($n)) {
            echo "‚ö†Ô∏è ERREUR : Le nom ne peut pas √™tre vide !<br>";
            return;
        }
        $this->nom = $n;
    }

    // GETTER : lire les PV
    public function getPV() {
        return $this->pv;
    }

    // SETTER : modifier les PV (avec CONTR√îLE ANTI-TRICHE !)
    public function setPV($pv) {
        if ($pv < 0) {
            echo "‚ö†Ô∏è ANTI-TRICHE : Les PV ne peuvent pas √™tre n√©gatifs !<br>";
            $this->pv = 0;
            return;
        }
        if ($pv > $this->pv_max) {
            echo "‚ö†Ô∏è ANTI-TRICHE : Les PV ne peuvent pas d√©passer le max !<br>";
            $this->pv = $this->pv_max;
            return;
        }
        $this->pv = $pv;
    }

    // GETTER : lire la force
    public function getForce() {
        return $this->force;
    }

    // SETTER : modifier la force (avec CONTR√îLE !)
    public function setForce($f) {
        if ($f < 0) {
            echo "‚ö†Ô∏è ANTI-TRICHE : La force ne peut pas √™tre n√©gative !<br>";
            return;
        }
        if ($f > 100) {
            echo "‚ö†Ô∏è ANTI-TRICHE : La force ne peut pas d√©passer 100 !<br>";
            return;
        }
        $this->force = $f;
    }

    public function recevoirDegats($degats) {
        $this->pv -= $degats;
        if ($this->pv < 0) {
            $this->pv = 0;
        }
        echo $this->nom . " re√ßoit " . $degats . " d√©g√¢ts ! (PV: " . $this->pv . "/" . $this->pv_max . ")<br>";
    }

    public function afficherInfo() {
        echo $this->nom . " - PV: " . $this->pv . "/" . $this->pv_max . ", Force: " . $this->force . "<br>";
    }
}

// Utilisation
$guerrier = new Personnage("Thorin", 120, 30);
$guerrier->afficherInfo();

echo "PV actuels : " . $guerrier->getPV() . "<br>";

// Essayons de tricher !
$guerrier->setPV(99999); // ‚ö†Ô∏è Bloqu√© par l'anti-triche !
$guerrier->setPV(-50); // ‚ö†Ô∏è Bloqu√© !
$guerrier->setForce(500); // ‚ö†Ô∏è Bloqu√© !

// Utilisation normale
$guerrier->recevoirDegats(30);
$guerrier->afficherInfo();
?>
```

---

### üì∫ R√©sultat :

```
Thorin - PV: 120/120, Force: 30
PV actuels : 120
‚ö†Ô∏è ANTI-TRICHE : Les PV ne peuvent pas d√©passer le max !
‚ö†Ô∏è ANTI-TRICHE : Les PV ne peuvent pas √™tre n√©gatifs !
‚ö†Ô∏è ANTI-TRICHE : La force ne peut pas d√©passer 100 !
Thorin re√ßoit 30 d√©g√¢ts ! (PV: 90/120)
Thorin - PV: 90/120, Force: 30
```

**Maintenant, les stats sont PROT√âG√âES contre la triche !** üõ°Ô∏è

---

## üîç D√©cortiquons les getters et setters

### Structure d'un GETTER

```php
public function getPV() {
    return $this->pv;
}
```

**`public`** ‚Üí Accessible de partout (c'est une porte d'acc√®s)

**`function getPV()`** ‚Üí Nom : **get** + **Nom de la stat** (convention)

**`return $this->pv;`** ‚Üí Je **renvoie** la valeur de la stat priv√©e

**Traduction :** *"Donne-moi les PV du personnage"*

---

### Structure d'un SETTER

```php
public function setPV($pv) {
    if ($pv < 0) {
        echo "‚ö†Ô∏è ANTI-TRICHE : Les PV ne peuvent pas √™tre n√©gatifs !<br>";
        $this->pv = 0;
        return;
    }
    if ($pv > $this->pv_max) {
        echo "‚ö†Ô∏è ANTI-TRICHE : Les PV ne peuvent pas d√©passer le max !<br>";
        $this->pv = $this->pv_max;
        return;
    }
    $this->pv = $pv;
}
```

**`public`** ‚Üí Accessible de partout

**`function setPV($pv)`** ‚Üí Nom : **set** + **Nom de la stat** + **param√®tre**

**`if ($pv < 0) { ... }`** ‚Üí **CONTR√îLE ANTI-TRICHE** avant d'accepter

**`$this->pv = $pv;`** ‚Üí Si c'est bon, je modifie la stat

**Traduction :** *"Change les PV, mais seulement si c'est pas de la triche"*

---

## üí° Pourquoi c'est G√âNIAL

### ‚úÖ Avantage 1 : Anti-triche

Tu emp√™ches les valeurs **impossibles** :
- PV n√©gatifs ou infinis
- Force n√©gative
- Stats qui d√©passent les limites

---

### ‚úÖ Avantage 2 : Contr√¥le

Tu peux ajouter des **r√®gles de jeu** :

```php
public function setPV($pv) {
    if ($pv > $this->pv_max) {
        echo "ü©π Les PV sont limit√©s au maximum !<br>";
        $this->pv = $this->pv_max;
        return;
    }
    $this->pv = $pv;
}
```

---

### ‚úÖ Avantage 3 : √âvolution

Si tu changes la structure interne, le code ext√©rieur ne casse pas :

```php
// Avant
private $pv; // stock√©s normalement

// Apr√®s (tu veux stocker en pourcentage)
private $pv_pourcentage;

public function getPV() {
    return ($this->pv_pourcentage / 100) * $this->pv_max; // Conversion automatique
}
```

Le code qui utilise `getPV()` continue de fonctionner sans modification !

---

## üõ°Ô∏è `protected` : pour les classes enfants

Quand tu veux qu'une stat soit **accessible aux classes enfants** mais **pas √† l'ext√©rieur** :

```php
<?php
class Personnage {
    protected $nom;
    protected $pv;

    public function __construct($n, $pv) {
        $this->nom = $n;
        $this->pv = $pv;
    }
}

class Guerrier extends Personnage {
    private $rage;

    public function __construct($n, $pv, $rage) {
        parent::__construct($n, $pv);
        $this->rage = $rage;
    }

    public function afficherInfo() {
        // ‚úÖ Je peux acc√©der √† nom et pv car ils sont protected
        echo "Guerrier : " . $this->nom . " (PV: " . $this->pv . ", Rage: " . $this->rage . ")<br>";
    }
}

$guerrier = new Guerrier("Thorin", 150, 20);
$guerrier->afficherInfo();

// ‚ùå Mais de l'ext√©rieur, on ne peut pas y acc√©der
// echo $guerrier->pv; // ERREUR !
?>
```

---

### üì∫ R√©sultat :

```
Guerrier : Thorin (PV: 150, Rage: 20)
```

**`protected` = acc√®s familial (parent + enfants) mais pas public !**

C'est comme les stats cach√©es dans un jeu : seul le syst√®me de jeu y a acc√®s ! üéÆ

---

## üìä Tableau r√©capitulatif

| Visibilit√© | Classe elle-m√™me | Classes enfants | Ext√©rieur |
|------------|------------------|-----------------|-----------|
| **`public`** | ‚úÖ Oui | ‚úÖ Oui | ‚úÖ Oui |
| **`protected`** | ‚úÖ Oui | ‚úÖ Oui | ‚ùå Non |
| **`private`** | ‚úÖ Oui | ‚ùå Non | ‚ùå Non |

---

## ‚úçÔ∏è EXERCICE PRATIQUE (le dernier !)

Cr√©e un fichier `exercice_encapsulation.php` et fais ceci :

### Instructions :

1. Cr√©e une classe `Inventaire` avec :
   - Propri√©t√© **priv√©e** : `$or` (l'argent du joueur)
   - Constructeur qui initialise l'or
   - M√©thode `getOr()` pour lire l'or
   - M√©thode `ajouterOr($montant)` qui ajoute de l'or (seulement si montant > 0)
   - M√©thode `retirerOr($montant)` qui retire de l'or (seulement si assez d'or)
   - M√©thode `afficherInventaire()` qui affiche l'or

2. Cr√©e un inventaire avec 100 pi√®ces d'or

3. Teste :
   - Ajouter 50 pi√®ces
   - Retirer 30 pi√®ces
   - Essayer de retirer 200 pi√®ces (√ßa doit √™tre refus√©)
   - Essayer d'ajouter -50 pi√®ces (√ßa doit √™tre refus√©)

---

### R√©sultat attendu :

```
üí∞ Inventaire : 100 pi√®ces d'or
‚úÖ +50 pi√®ces d'or gagn√©es !
üí∞ Inventaire : 150 pi√®ces d'or
‚úÖ -30 pi√®ces d'or d√©pens√©es !
üí∞ Inventaire : 120 pi√®ces d'or
‚ö†Ô∏è ERREUR : Pas assez d'or !
üí∞ Inventaire : 120 pi√®ces d'or
‚ö†Ô∏è ERREUR : Le montant doit √™tre positif !
üí∞ Inventaire : 120 pi√®ces d'or
```

---

<details>
<summary>üìù Voir la solution (clique pour d√©plier)</summary>

```php
<?php
class Inventaire {
    private $or;

    public function __construct($or_initial) {
        $this->or = $or_initial;
    }

    public function getOr() {
        return $this->or;
    }

    public function ajouterOr($montant) {
        if ($montant <= 0) {
            echo "‚ö†Ô∏è ERREUR : Le montant doit √™tre positif !<br>";
            return;
        }
        $this->or += $montant;
        echo "‚úÖ +" . $montant . " pi√®ces d'or gagn√©es !<br>";
    }

    public function retirerOr($montant) {
        if ($montant > $this->or) {
            echo "‚ö†Ô∏è ERREUR : Pas assez d'or !<br>";
            return;
        }
        $this->or -= $montant;
        echo "‚úÖ -" . $montant . " pi√®ces d'or d√©pens√©es !<br>";
    }

    public function afficherInventaire() {
        echo "üí∞ Inventaire : " . $this->or . " pi√®ces d'or<br>";
    }
}

$inventaire = new Inventaire(100);
$inventaire->afficherInventaire();

$inventaire->ajouterOr(50);
$inventaire->afficherInventaire();

$inventaire->retirerOr(30);
$inventaire->afficherInventaire();

$inventaire->retirerOr(200);
$inventaire->afficherInventaire();

$inventaire->ajouterOr(-50);
$inventaire->afficherInventaire();
?>
```

</details>

---

## üß† Ce que tu DOIS retenir de ce cours

‚úÖ **`public`** = Accessible partout (utilise avec prudence)

‚úÖ **`private`** = Accessible seulement dans la classe (protection maximale)

‚úÖ **`protected`** = Accessible dans la classe + les enfants (pour l'h√©ritage)

‚úÖ **GETTER** = M√©thode pour **LIRE** une stat priv√©e (`getPV()`)

‚úÖ **SETTER** = M√©thode pour **MODIFIER** une stat priv√©e avec contr√¥le (`setPV($pv)`)

‚úÖ **L'encapsulation prot√®ge contre la triche et les erreurs**

---

## üéì R√©capitulatif de TOUTE la formation POO

**Cours 01** : Comprendre classe vs objet ‚Üí Template vs personnage spawn√©  
**Cours 02** : Cr√©er ses premiers personnages ‚Üí `new`, propri√©t√©s, `->`  
**Cours 03** : Ajouter des actions ‚Üí M√©thodes, `$this`, attaquer, se soigner  
**Cours 04** : Simplifier le spawn ‚Üí Constructeur `__construct`  
**Cours 05** : Syst√®mes de classes ‚Üí H√©ritage `extends`, Guerrier/Mage/Archer  
**Cours 06** : Anti-triche ‚Üí `private`, getters/setters, contr√¥les  

**TU AS MAINTENANT LES BASES SOLIDES DE LA POO !** üéâ

---

## üöÄ Et maintenant ?

Tu peux maintenant :

‚úÖ Cr√©er tes propres syst√®mes de personnages  
‚úÖ Organiser ton code de jeu proprement  
‚úÖ R√©utiliser du code avec l'h√©ritage  
‚úÖ Prot√©ger contre la triche  
‚úÖ Lire et comprendre du code orient√© objet  

**Prochaines √©tapes possibles :**
- Cr√©er un mini-jeu RPG complet (syst√®me de combat, inventaire, qu√™tes...)
- Apprendre les concepts avanc√©s (interfaces, traits, namespaces...)
- D√©couvrir les frameworks PHP (Laravel, Symfony...) qui utilisent MASSIVEMENT la POO

---

## üí™ Conseil final

La POO, c'est comme un jeu vid√©o :

**Au d√©but**, √ßa semble compliqu√© avec plein de r√®gles.  
**Avec la pratique**, √ßa devient naturel et amusant.  
**Avec l'exp√©rience**, tu te demandes comment tu codais avant !

**Continue √† pratiquer, cr√©e des projets, fais des erreurs, corrige-les !**

C'est en **CODANT** qu'on devient d√©veloppeur, pas en lisant ! üíª

---

**üéÆ GG WP pour avoir termin√© cette formation !**

**Tu es maintenant un dev capable de cr√©er des syst√®mes de jeu solides et bien organis√©s !** üèÜ

*PS : Garde ces cours comme r√©f√©rence. Relis-les quand tu as un doute. Et surtout... CODE, CODE, CODE ! üî•*

*PPS : N'oublie pas : les meilleurs jeux sont ceux qu'on partage. Partage ton code, aide les autres gamers, et continue d'apprendre ! üéÆ*